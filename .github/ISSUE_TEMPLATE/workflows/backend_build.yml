name: Backend Docker Build

on:
  workflow_dispatch:
  # push:
  #   branches: [ develop ]
  #   paths: 
  #     - 'app/backend/**'

jobs:

  build-and-push:
    runs-on: ubuntu-latest

    env:
      working-directory: ./app/backend

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Build Docker image
      working-directory: ${{env.working-directory}}
      run: |
        docker build -t erkamkavak/gamelounge-backend:${{ github.run_number }} .

    - name: Login to Docker Hub
      run: echo "gameLounge2019" | docker login -u "erkamkavak" --password-stdin

    - name: Push Docker image
      run: |
        docker push erkamkavak/gamelounge-backend:${{ github.run_number }}